<!doctype html>
<html>
<head>
<meta charset='utf-8'/>
<title>DEAT JSON Editor</title>
<style>
  body{font-family:Arial;margin:20px}
  #editor{height:400px;border:1px solid #ccc;margin-bottom:10px;}
  button{margin:2px;}
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.9.6/ace.js"></script>
<script src="/static/ws-client.js"></script>
</head>
<body>
<h3>DEAT JSON Editor</h3>
<p>Vyber endpoint a ode≈°li JSON payload.</p>
<select id="endpoint">
  <option value="/arc">/arc</option>
  <option value="/cr">/cr</option>
  <option value="/nur">/nur</option>
</select>
<button onclick="send()">Send</button>

<h4>Load Sample Payloads</h4>
<!-- ARC -->
<button onclick="loadARCv1()">ARC v1</button>
<button onclick="loadARCv2()">ARC v2</button>
<!-- CR -->
<button onclick="loadCRv1()">CR v1</button>
<button onclick="loadCRv2()">CR v2</button>
<!-- NUR -->
<button onclick="loadNURv1()">NUR v1</button>
<button onclick="loadNURv2()">NUR v2</button>

<div id="editor">{
  "signals": {
    "CN": {"concentration": 0.85},
    "RU": {"entropy": 0.4},
    "US": {"profit_bias": 0.6}
  },
  "adapt_delta": {"cn":0.02, "ru":-0.01, "us":0.0}
}</div>

<h4>Response</h4>
<pre id="response"></pre>

<script>
var editor = ace.edit('editor');
editor.session.setMode('ace/mode/json');
editor.setValue(editor.getValue(), -1);

// --- Send JSON to selected endpoint ---
function send(){
  var endpoint = document.getElementById('endpoint').value;
  var payload = editor.getValue();
  fetch(endpoint, {
    method:'POST', 
    headers:{'Content-Type':'application/json'}, 
    body: payload
  })
  .then(r=>r.json())
  .then(j=>document.getElementById('response').innerText = JSON.stringify(j, null, 2))
  .catch(e=>document.getElementById('response').innerText = e);
}

// --- ARC samples ---
function loadARCv1(){
  var payload = {
    signals: {CN:{concentration:0.9}, RU:{entropy:0.1}, US:{profit_bias:0.5}},
    adapt_delta: {cn:0.01, ru:-0.01, us:0.0}
  };
  editor.setValue(JSON.stringify(payload, null, 2), -1);
}
function loadARCv2(){
  var payload = {
    signals: {CN:{concentration:0.5}, RU:{entropy:0.7}, US:{profit_bias:0.2}},
    adapt_delta: {cn:0.0, ru:0.02, us:-0.01}
  };
  editor.setValue(JSON.stringify(payload, null, 2), -1);
}

// --- CR samples ---
function loadCRv1(){
  var payload = {
    provocations:[
      {intensity:0.2, source_type:"individual", vector:"social", confidence:0.8},
      {intensity:0.3, source_type:"individual", vector:"financial", confidence:0.9}
    ]
  };
  editor.setValue(JSON.stringify(payload, null, 2), -1);
}
function loadCRv2(){
  var payload = {
    provocations:[
      {intensity:0.6, source_type:"state", vector:"media", confidence:0.7},
      {intensity:0.8, source_type:"agency", vector:"politics", confidence:0.5},
      {intensity:0.5, source_type:"individual", vector:"finance", confidence:0.4}
    ]
  };
  editor.setValue(JSON.stringify(payload, null, 2), -1);
}

// --- NUR samples ---
function loadNURv1(){
  var payload = {
    assets:{real_estate:50000, savings:20000, stocks:10000},
    passive_income:2000,
    active_input:500
  };
  editor.setValue(JSON.stringify(payload, null, 2), -1);
}
function loadNURv2(){
  var payload = {
    assets:{real_estate:20000, savings:5000, stocks:2000},
    passive_income:500,
    active_input:2000
  };
  editor.setValue(JSON.stringify(payload, null, 2), -1);
}
</script>
</body>
</html>
